@startuml
autonumber
hide footbox

actor "Human Resource Representative" as HRR

participant "<<presentation>>\nCollaboratorSpecificationUI" as UI
participant "<<aplication>>\nCollaboratorSpecificationController" as CTRL
participant "<<builder>>\nCollaboratorBuilder" as CB
participant "<<domain>>\ncolab:Collaborator" as COLAB
participant "<<persistence>>\nPersistenceContex" as PC
participant "<<persistence>>\nAppSettings" as AS
participant "<<factory>>\nRepositoryFactory" as RF
database "<<repository>>\nRoleRepository" as RR
database "<<repository>>\nCollaboratorRepository" as CR

participant "<<domain>>\nShortName" as SN
participant "<<domain>>\nCompleteName" as CN
participant "<<domain>>\nMechanographicNumber" as MN
participant "<<domain>>\nRole" as R
participant "<<domain>>\nAddress" as A
participant "<<domain>>\nPhoneNumber" as PN
participant "<<domain>>\nBirthDate" as BD

activate HRR

HRR-> UI : Iniciates the request to specify a collaborator
activate UI

UI-> CTRL** : create()

UI --> HRR: Request all information needed (i.e. short and complete name,\nmechanographic number, address, phone number, birth date)

deactivate UI
HRR-> UI : Inserts the requested information
activate UI
UI-> CTRL : addColaborador(shortName, completeName, mechanographicNumber,\naddress, phoneNumber, birthDate)
activate CTRL

CTRL-> CB** : create()
CTRL-> CB : withShortName(shortName)
activate CB
CTRL-> CB : withCompleteName(completeName)
CTRL-> CB : withMechanographicNumber(mechanographicNumber)
CTRL-> CB : withAddress(address)
CTRL-> CB : withPhoneNumber(phoneNumber)
CTRL-> CB : withBirthDate(birthDate)
deactivate CB
deactivate CTRL

UI-> CTRL : getRoleList()
activate CTRL
CTRL-> PC: repositories()
activate PC
PC-> AS : instance()
activate AS
deactivate AS
PC -> AS : getRepositoryFactory()
activate AS

AS -> RF** : create
AS --> PC : factory
PC --> CTRL : factory
deactivate AS
deactivate PC

CTRL-> RF : roles()
activate RF
RF-> RR** : create()
RF--> CTRL : roleRepository
deactivate RF

CTRL -> RR : save(role)
activate RR
RR --> CTRL : role
deactivate RR
CTRL --> UI : role


UI --> HRR: Shows roles' list
deactivate UI
deactivate CTRL


HRR-> UI : Select the intended role
activate UI

UI-> CTRL : addRole(role)
activate CTRL
CTRL-> CB : withRole(role)
activate CB
deactivate CB
deactivate CTRL

UI --> HRR: Validates, presents the information and asks for confirmation
deactivate UI

deactivate UI
HRR-> UI : Confirms
activate UI

UI-> CTRL : saveColaborator()
activate CTRL

CTRL-> CB : createCollaborator()
activate CB
CB-> COLAB** : create(shortName, completeName, mechanographicNumber,\naddress, phoneNumber, birthDate,role)

activate COLAB
COLAB --> CB : collaborator
deactivate COLAB
CB --> CTRL : collaborator
deactivate CB

CTRL-> PC: repositories()
activate PC
PC-> RF** : create()
PC--> CTRL : factory
deactivate PC

CTRL-> RF : collaborators()
activate RF
RF-> CR** : create()
RF--> CTRL : collaboratorRepository
deactivate RF

CTRL-> CR : save(collaborator)
activate CR
CR --> CTRL : collaborator
deactivate CR
CTRL --> UI : collaborator
deactivate CTRL

UI --> HRR: Informs of the success of the operation
deactivate UI
deactivate HRR

@enduml